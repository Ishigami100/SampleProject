<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use Illuminate\Support\Facades\Auth; //追加
use Illuminate\Support\Facades\Log;
use Illuminate\Support\Str;
use Illuminate\Support\Facades\DB;

use App\Models\Image;

class DrawStoreController extends Controller
{


    public function delete(Request $request)
    {

        // 画像保存
        $image = "data:image/png;base64,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";


        //base64をデコードする前の下準備
        $image = str_replace('data:image/png;base64,', '', $image);
        $image = str_replace(' ', '+', $image);  // 空白を'+'に変換

        //ユーザ情報の取得とファイル名の確定
        $user = $request->input("user");  // your base64 encoded
        $imageName =$user.'.'.'png';

        \File::put(storage_path(). '/app/public/' . $imageName, base64_decode($image));

    }


}
